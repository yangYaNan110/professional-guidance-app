# ä¸“ä¸šæ¨èæ¨¡å—ä¸šåŠ¡é€»è¾‘è§„æ ¼è¯´æ˜ä¹¦

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

**æ¨¡å—åç§°**: ä¸“ä¸šæ¨èæ¨¡å—  
**ä¸šåŠ¡åŸŸ**: ä¸“ä¸šé€‰æ‹©æŒ‡å¯¼  
**å¼€å‘çŠ¶æ€**: âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°**: 2026-01-25  
**ç‰ˆæœ¬**: v1.0  

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•°æ®æµæ¶æ„
```
å‰ç«¯ç•Œé¢ (React:3000) 
    â†“ HTTP APIè°ƒç”¨
åç«¯APIæœåŠ¡ (FastAPI:8002)
    â†“ æ•°æ®åº“æŸ¥è¯¢
PostgreSQLæ•°æ®åº“ (major-postgres:5432)
```

### æ ¸å¿ƒç»„ä»¶
- **å‰ç«¯**: `frontend/web/src/pages/MajorsPage.tsx`
- **åç«¯**: `backend/major-service/recommendation_api_new.py`
- **ä¸šåŠ¡é€»è¾‘**: `backend/major-service/recommendation_engine.py`
- **æ•°æ®åº“**: `major_categories`ã€`majors`ã€`major_market_data`

---

## ğŸ“Š æ•°æ®æ¨¡å‹

### 1. ä¸“ä¸šåˆ†ç±»è¡¨ (major_categories)
```sql
CREATE TABLE major_categories (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100) NOT NULL,        -- åˆ†ç±»åç§°ï¼šå“²å­¦ã€ç»æµå­¦ã€æ³•å­¦...
    code VARCHAR(20),                   -- å­¦ç§‘ä»£ç ï¼š01ã€02ã€03...
    level INTEGER DEFAULT 1,            -- åˆ†ç±»å±‚çº§
    sort_order INTEGER DEFAULT 0,       -- æ’åºé¡ºåº
    description TEXT,                   -- åˆ†ç±»æè¿°
    source_url VARCHAR(500),            -- æ•°æ®æºURL
    source_website VARCHAR(100),         -- æ•°æ®æºç½‘ç«™
    crawled_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

### 2. ä¸“ä¸šåŸºç¡€ä¿¡æ¯è¡¨ (majors)
```sql
CREATE TABLE majors (
    id INTEGER PRIMARY KEY,
    name VARCHAR(200) NOT NULL,         -- ä¸“ä¸šåç§°
    code VARCHAR(20),                   -- ä¸“ä¸šä»£ç 
    category_id INTEGER,                 -- æ‰€å±åˆ†ç±»ID
    category_name VARCHAR(100),          -- æ‰€å±åˆ†ç±»åç§°
    level INTEGER DEFAULT 1,            -- ä¸“ä¸šå±‚çº§
    duration VARCHAR(50),                -- å­¦åˆ¶å¹´é™
    description TEXT,                    -- ä¸“ä¸šæè¿°
    courses JSONB,                       -- è¯¾ç¨‹è®¾ç½®
    career_prospects TEXT,              -- å°±ä¸šå‰æ™¯
    source_url VARCHAR(500),             -- æ•°æ®æºURL
    source_website VARCHAR(100),         -- æ•°æ®æºç½‘ç«™
    crawled_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    FOREIGN KEY (category_id) REFERENCES major_categories(id)
);
```

### 3. ä¸“ä¸šè¡Œæƒ…æ•°æ®è¡¨ (major_market_data)
```sql
CREATE TABLE major_market_data (
    id SERIAL PRIMARY KEY,
    major_name VARCHAR(200),             -- ä¸“ä¸šåç§°
    category VARCHAR(100),               -- ä¸“ä¸šåˆ†ç±»
    employment_rate DECIMAL(5,2),       -- å°±ä¸šç‡ (0-100)
    avg_salary DECIMAL(10,2),           -- å¹³å‡è–ªèµ„
    heat_index DECIMAL(5,2),            -- çƒ­åº¦æŒ‡æ•° (0-100)
    industry_demand_score DECIMAL(3,1),  -- è¡Œä¸šéœ€æ±‚è¯„åˆ† (0-10)
    future_prospects_score DECIMAL(3,1),-- å‘å±•å‰æ™¯è¯„åˆ† (0-10)
    talent_shortage BOOLEAN,            -- äººæ‰çŸ­ç¼ºæ ‡è®°
    data_period VARCHAR(50),             -- æ•°æ®å‘¨æœŸ
    description TEXT,                    -- ä¸“ä¸šæè¿°
    courses JSONB,                       -- è¯¾ç¨‹è®¾ç½®
    career_prospects TEXT,              -- å°±ä¸šå‰æ™¯
    source_url VARCHAR(1000) UNIQUE,     -- æ•°æ®æºURL
    source_website VARCHAR(100),         -- æ•°æ®æºç½‘ç«™
    crawled_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    created_at TIMESTAMP DEFAULT NOW()
);
```

---

## ğŸ”Œ APIæ¥å£è§„èŒƒ

### 1. è·å–ä¸“ä¸šåˆ†ç±»åˆ—è¡¨
```yaml
GET /api/v1/categories
Response: {
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "å“²å­¦",
      "code": "01", 
      "level": 1
    }
    // ... å…±13ä¸ªå­¦ç§‘åˆ†ç±»
  ],
  "message": "æˆåŠŸè·å– 13 ä¸ªä¸“ä¸šåˆ†ç±»",
  "timestamp": "2026-01-25T12:46:58.549907"
}
```

### 2. è·å–ä¸“ä¸šæ¨èåˆ—è¡¨
```yaml
GET /api/v1/recommendations?page=1&page_size=10&sort_by=heat_index&sort_order=desc&category_id=null

Response: {
  "success": true,
  "data": {
    "success": true,
    "data": [
      {
        "id": 1,
        "name": "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯",
        "category_name": "å·¥å­¦",
        "employment_rate": 96.5,
        "avg_salary": 15000,
        "heat_index": 77.17,
        "industry_demand_score": 9.2,
        "future_prospects_score": 9.5,
        "talent_shortage": true,
        "data_period": "2023å¹´åº¦",
        "description": null
      }
      // ... æ›´å¤šä¸“ä¸šæ•°æ®
    ],
    "pagination": {
      "page": 1,
      "page_size": 10,
      "total_count": 5,
      "total_pages": 1,
      "has_next": false,
      "has_prev": false
    },
    "filters": {
      "category_id": null,
      "sort_by": "heat_index", 
      "sort_order": "desc"
    },
    "message": "æˆåŠŸè·å– 5 ä¸ªä¸“ä¸šæ¨è"
  },
  "message": "æˆåŠŸè·å– 5 ä¸ªä¸“ä¸šæ¨è",
  "timestamp": "2026-01-25T12:47:29.830306"
}
```

### 3. è·å–ä¸“ä¸šè¯¦æƒ…
```yaml
GET /api/v1/majors/{major_id}
Response: {
  "success": true,
  "data": {
    // ä¸“ä¸šè¯¦ç»†ä¿¡æ¯
  }
}
```

---

## ğŸ¯ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

### 1. æ¨èæ’åºç®—æ³•

#### çƒ­åº¦æŒ‡æ•°è®¡ç®—æ¨¡å‹
```python
heat_index = (
    w1 Ã— æœç´¢çƒ­åº¦ +      # 0.30
    w2 Ã— å°±ä¸šç‡ +        # 0.25  
    w3 Ã— è–ªèµ„æ°´å¹³ +      # 0.20
    w4 Ã— å‘å±•è¶‹åŠ¿ +      # 0.15
    w5 Ã— æ‹›ç”Ÿè§„æ¨¡        # 0.10
)
```

#### æ’åºå­—æ®µæ”¯æŒ
- **heat_index**: çƒ­åº¦æŒ‡æ•°ï¼ˆé»˜è®¤æ’åºï¼‰
- **employment_rate**: å°±ä¸šç‡
- **avg_salary**: å¹³å‡è–ªèµ„  
- **future_prospects**: å‘å±•å‰æ™¯
- **industry_demand**: è¡Œä¸šéœ€æ±‚
- **crawled_at**: æ›´æ–°æ—¶é—´

### 2. åˆ†ç±»ç­›é€‰é€»è¾‘

#### åˆ†ç±»ç­›é€‰è§„åˆ™
- æ”¯æŒ13ä¸ªå­¦ç§‘åˆ†ç±»ç­›é€‰
- ç­›é€‰æ¡ä»¶ï¼š`category_id = ç›®æ ‡åˆ†ç±»ID`
- ä¸é€‰æ‹©åˆ†ç±»æ—¶æ˜¾ç¤ºæ‰€æœ‰ä¸“ä¸š

#### åˆ†ç±»æ•°æ®ç®¡ç†
- åˆ†ç±»æ•°æ®æ¥è‡ª`major_categories`è¡¨
- æŒ‰`sort_order, name`æ’åº
- æ— statuså­—æ®µé™åˆ¶ï¼ˆç§»é™¤äº†é”™è¯¯çš„status=1æ¡ä»¶ï¼‰

### 3. åˆ†é¡µå¤„ç†æœºåˆ¶

#### åˆ†é¡µå‚æ•°
- **page**: é¡µç ï¼Œä»1å¼€å§‹
- **page_size**: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- **total_count**: æ€»è®°å½•æ•°
- **total_pages**: æ€»é¡µæ•°
- **has_next**: æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
- **has_prev**: æ˜¯å¦æœ‰ä¸Šä¸€é¡µ

#### åˆ†é¡µé€»è¾‘
- å‰ç«¯åŠ è½½æ›´å¤šæ—¶ä¿æŒç°æœ‰æ•°æ®
- APIæ”¯æŒåŠ¨æ€åˆ†é¡µå‚æ•°
- åˆ†é¡µä¿¡æ¯åŒ…å«åœ¨å“åº”çš„paginationå¯¹è±¡ä¸­

---

## ğŸ¨ å‰ç«¯ç•Œé¢é€»è¾‘

### 1. æ•°æ®å±•ç¤ºç»“æ„
```typescript
interface Major {
  id: string;                    // ä¸“ä¸šID
  name: string;                  // ä¸“ä¸šåç§°
  category: string;               // ä¸“ä¸šåˆ†ç±»
  duration: string;               // å­¦åˆ¶ï¼ˆå›ºå®š4å¹´ï¼‰
  courses: string[];             // è¯¾ç¨‹è®¾ç½®
  employmentRate: string;         // å°±ä¸šç‡æ ¼å¼åŒ–ä¸º"XX%"
  avgSalary: string;              // è–ªèµ„æ ¼å¼åŒ–ä¸º"Â¥XXk"
  matchScore: number;             // åŒ¹é…åˆ†æ•°ï¼ˆä½¿ç”¨heat_indexï¼‰
  crawledAt: string;              // çˆ¬å–æ—¶é—´
}
```

### 2. äº¤äº’åŠŸèƒ½

#### åˆ†ç±»ç­›é€‰
- ä¸‹æ‹‰é€‰æ‹©å™¨åŒ…å«"å…¨éƒ¨å­¦ç§‘" + 13ä¸ªå…·ä½“åˆ†ç±»
- é€‰æ‹©åˆ†ç±»åè§¦å‘APIé‡æ–°è·å–æ•°æ®
- é‡ç½®é¡µç ä¸ºç¬¬1é¡µ

#### æ’åºåŠŸèƒ½
- æ”¯æŒ4ç§æ’åºæ–¹å¼ï¼šç»¼åˆæ’åºã€å°±ä¸šç‡ã€è–ªèµ„ã€æœ€æ–°æ›´æ–°
- é»˜è®¤æŒ‰çƒ­åº¦æŒ‡æ•°é™åºæ’åˆ—
- æ’åºå˜æ›´æ—¶é‡æ–°è·å–æ•°æ®

#### åŠ è½½æ›´å¤š
- åˆ†é¡µåŠ è½½ï¼Œä¿æŒå·²åŠ è½½æ•°æ®
- æ»šåŠ¨åˆ°åº•éƒ¨è‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µ
- åŠ è½½çŠ¶æ€æ˜¾ç¤ºloading indicator

### 3. é”™è¯¯å¤„ç†

#### APIé”™è¯¯å¤„ç†
- ç½‘ç»œé”™è¯¯æ˜¾ç¤ºå‹å¥½æç¤º
- æ•°æ®è§£æé”™è¯¯æ—¶æ˜¾ç¤ºé»˜è®¤å€¼
- åŠ è½½çŠ¶æ€ç®¡ç†ï¼ˆloading/loadingMoreï¼‰

#### æ•°æ®å®¹é”™
- ç©ºæ•°æ®æ—¶æ˜¾ç¤º"æš‚æ— æ•°æ®"
- ç¼ºå¤±å­—æ®µæ—¶æä¾›é»˜è®¤å€¼
- APIå“åº”ç»“æ„å˜åŒ–æ—¶çš„é€‚é…é€»è¾‘

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Python 3.11 + FastAPI 0.109.x
- **æ•°æ®åº“**: PostgreSQL 15 + psycopg2
- **æ•°æ®éªŒè¯**: å†…ç½®SQLå‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢æ³¨å…¥
- **å“åº”æ ¼å¼**: ç»Ÿä¸€çš„APIResponseåŒ…è£…ç±»
- **CORS**: æ”¯æŒæ‰€æœ‰è·¨åŸŸè¯·æ±‚

### 2. å‰ç«¯æŠ€æœ¯æ ˆ  
- **æ¡†æ¶**: React 18 + TypeScript
- **çŠ¶æ€ç®¡ç†**: React Hooks (useState, useEffect)
- **HTTPå®¢æˆ·ç«¯**: åŸç”Ÿfetch API
- **æ„å»ºå·¥å…·**: Vite
- **ç«¯å£**: 3000

### 3. æ•°æ®åº“ä¼˜åŒ–
- **ç´¢å¼•è®¾è®¡**: 
  - `major_categories`: sort_order, name
  - `major_market_data`: major_name, category, heat_index
- **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé¿å…SQLæ³¨å…¥
- **è¿æ¥ç®¡ç†**: å•ä¾‹æ•°æ®åº“è¿æ¥ï¼Œé¿å…è¿æ¥æ³„éœ²

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### APIæ€§èƒ½è¦æ±‚
- **å“åº”æ—¶é—´**: P95 < 500ms, P99 < 1s
- **é”™è¯¯ç‡**: < 1%
- **å¯ç”¨æ€§**: > 99.9%
- **å¹¶å‘æ”¯æŒ**: > 1000 TPS

### å‰ç«¯æ€§èƒ½è¦æ±‚
- **é¦–å±åŠ è½½**: < 3s
- **äº¤äº’å“åº”**: < 1s
- **åˆ†é¡µåŠ è½½**: < 500ms
- **è·¨æµè§ˆå™¨å…¼å®¹**: Chrome/Firefox/Safari/Edge

---

## ğŸ” æ•°æ®å®‰å…¨ä¸åˆè§„

### 1. æ•°æ®æ¥æºåˆè§„æ€§
- **é˜³å…‰é«˜è€ƒ**: å®˜æ–¹æƒå¨æ•°æ®æº
- **æ•™è‚²éƒ¨ç½‘ç«™**: æ”¿ç­–æƒå¨æ•°æ®
- **é«˜æ ¡å®˜ç½‘**: å®˜æ–¹æ‹›ç”Ÿä¿¡æ¯
- **ç¬¬ä¸‰æ–¹ç½‘ç«™**: è¾…åŠ©å‚è€ƒæ•°æ®

### 2. æ•°æ®å¤„ç†è§„èŒƒ
- **å»é‡æœºåˆ¶**: åŸºäºsource_urlå»é‡
- **æ•°æ®éªŒè¯**: æ ¼å¼æ ¡éªŒã€å®Œæ•´æ€§æ£€æŸ¥
- **ç‰ˆæœ¬ç®¡ç†**: æ•°æ®æ›´æ–°æ—¶ä¿ç•™å†å²ç‰ˆæœ¬
- **éšç§ä¿æŠ¤**: æ— ä¸ªäººæ•æ„Ÿä¿¡æ¯

### 3. å®‰å…¨æªæ–½
- **SQLæ³¨å…¥é˜²æŠ¤**: å‚æ•°åŒ–æŸ¥è¯¢
- **XSSé˜²æŠ¤**: è¾“å…¥è¾“å‡ºè½¬ä¹‰
- **CORSé…ç½®**: æ˜ç¡®çš„è·¨åŸŸç­–ç•¥
- **é”™è¯¯ä¿¡æ¯**: é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²

---

## ğŸš€ éƒ¨ç½²ä¸è¿ç»´

### 1. æœåŠ¡ç«¯å£
- **å‰ç«¯æœåŠ¡**: http://localhost:3000
- **åç«¯API**: http://localhost:8002
- **æ•°æ®åº“**: localhost:5432 (å®¹å™¨major-postgres)

### 2. å¯åŠ¨é¡ºåº
1. æ•°æ®åº“æœåŠ¡ (PostgreSQL)
2. åç«¯APIæœåŠ¡ (FastAPI)
3. å‰ç«¯å¼€å‘æœåŠ¡å™¨ (React)

### 3. å¥åº·æ£€æŸ¥
- APIæ ¹è·¯å¾„: `GET /` è¿”å›æœåŠ¡ä¿¡æ¯
- æ•°æ®åº“è¿æ¥: è‡ªåŠ¨æ£€æµ‹è¿æ¥çŠ¶æ€
- é”™è¯¯ç›‘æ§: ç»Ÿä¸€é”™è¯¯æ—¥å¿—æ ¼å¼

---

## ğŸ“ ä¸šåŠ¡è§„åˆ™æ€»ç»“

### ä¸å¯å˜æ›´çš„æ ¸å¿ƒè§„åˆ™
1. **æ•°æ®çœŸå®æ€§**: æ‰€æœ‰å±•ç¤ºæ•°æ®å¿…é¡»æ¥è‡ªçœŸå®ç½‘ç«™çˆ¬å–ï¼Œç¦æ­¢æ¨¡æ‹Ÿæ•°æ®
2. **APIå“åº”æ ¼å¼**: å¿…é¡»ä¿æŒ{success, data, message, timestamp}ç»“æ„
3. **æ’åºé€»è¾‘**: é»˜è®¤æŒ‰heat_indexé™åºï¼Œä¿æŒè®¡ç®—æ¨¡å‹ä¸å˜
4. **åˆ†ç±»ä½“ç³»**: 13ä¸ªå­¦ç§‘åˆ†ç±»ç»“æ„å›ºå®šï¼ŒæŒ‰ä»£ç æ’åº
5. **åˆ†é¡µæœºåˆ¶**: ä¿æŒåˆ†é¡µå‚æ•°å’Œå“åº”ç»“æ„ä¸€è‡´æ€§

### å¯æ‰©å±•çš„é…ç½®é¡¹
1. **æ’åºå­—æ®µ**: å¯æ–°å¢æ’åºå­—æ®µï¼Œä½†ä¿æŒç°æœ‰å­—æ®µä¸å˜
2. **åˆ†é¡µå¤§å°**: å¯è°ƒæ•´é»˜è®¤å€¼å’Œæœ€å¤§å€¼é™åˆ¶
3. **ç¼“å­˜ç­–ç•¥**: å¼€å‘æœŸé—´ç¦ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒå¯å¯ç”¨Redisç¼“å­˜
4. **UIæ ·å¼**: ç•Œé¢æ ·å¼å¯ä¼˜åŒ–ï¼Œä½†äº¤äº’é€»è¾‘ä¿æŒä¸€è‡´

### ç´§æ€¥ä¿®å¤æœºåˆ¶
1. **æ•°æ®å¼‚å¸¸**: å‘ç°æ•°æ®é”™è¯¯æ—¶å¯ç´§æ€¥ä¿®æ­£ï¼Œä½†ä¿ç•™ä¿®æ”¹æ—¥å¿—
2. **æ€§èƒ½é—®é¢˜**: å‡ºç°æ€§èƒ½ç“¶é¢ˆæ—¶å¯ä¼˜åŒ–æŸ¥è¯¢ï¼Œä¿æŒæ¥å£å…¼å®¹æ€§
3. **å®‰å…¨æ¼æ´**: å®‰å…¨é—®é¢˜å¯ç´§æ€¥ä¿®å¤ï¼Œç«‹å³éƒ¨ç½²æ›´æ–°

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **éœ€æ±‚è®¾è®¡æ–‡æ¡£**: `/éœ€æ±‚è®¾è®¡.md`
- **æŠ€æœ¯æ¶æ„**: `/backend/major-service/README.md`
- **APIæ–‡æ¡£**: å†…ç½®OpenAPIæ–‡æ¡£ http://localhost:8002/docs
- **æ•°æ®åº“è®¾è®¡**: `/backend/major-service/schema.sql`

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2026-01-25  
**ç»´æŠ¤è´£ä»»**: Coordinator Agent  
**å˜æ›´æƒé™**: é‡å¤§å˜æ›´éœ€ç”¨æˆ·ç¡®è®¤ï¼Œå°é—®é¢˜ä¿®å¤å¯è‡ªä¸»å¤„ç†  

> âš ï¸ **é‡è¦æé†’**: æ­¤ä¸šåŠ¡é€»è¾‘ä¸ºä¸“ä¸šæ¨èæ¨¡å—çš„æ ¸å¿ƒè§„èŒƒï¼Œåç»­æ–°å¼€å¯¹è¯çª—å£æ—¶å¿…é¡»ä¸¥æ ¼éµå¾ªã€‚é™¤éæ•°æ®ä¸è¶³éœ€è¦é‡æ–°çˆ¬å–ï¼Œæˆ–æ–°å¢æ¨¡å—éœ€è¦ç³»ç»Ÿæ¶æ„è°ƒæ•´ï¼Œå¦åˆ™ä¸å¾—è½»æ˜“å˜æ›´æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚